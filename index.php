<?php
/* *
*Точка входа 
 */

/**
 * Загрузчик  для загрузки встречающихся классов классов* /
 */
  function __autoload($class){
        $directories = array('controller/','model/');
        foreach($directories as $directory){
        $file = $directory.$class.'.php';
            if(file_exists($file) && is_readable($file)){
                    require $file;
                    return;
                    }
                }		
          }
 /**
* снанчало проверяем массивы POST[] и GET[], если они не пустые то
*обрабатваем данные формы , если наоборот то проверяем просто массив GET[], 
*который может быть не пустым если нажималась кнопка формы 
*/            
//if(isset($_GET['mth'])) echo'$_GET[mth] = '.$_GET['mth'].'<br>'; 
    if(isset($_POST['user']) & isset($_POST['password'])
             & !empty($_POST['user']) & !empty($_POST['password'])){
        /*определяем используемый метод для передачи объекту*/
         if(isset($_GET['mth']) && ($_GET['mth'] ==='verify' || $_GET['mth'] === 'registration')){
             $method = $_GET['mth'];
           //  echo '$method = '.$method;
         }else{
             die('А вот не надо взламывать код!');
         }
// echo '$method - '.$method.'<br>';       
        //создаем объект контролирующий входные данные и вызываем метод
        $contr = new UserScan;
        $user = $contr->$method();
/*Если POST[]  пустой , а массив GET[] не пустой значит нажималась кнопка формы
при не запоолненных полях , выводим сообщение*/               
    }else if(isset($_GET['mth']) && !empty($_GET['mth'])){
            ob_start();
            $msg = 'Для входа в админку заполните форму.Поля не должны быть пустыми';
             require'view/message.php';
            $message = ob_get_contents();
            ob_end_flush(); 
             require'view/login_page.php';
     }else{
            require 'view/main.php';
     }
           
    